name: pii-masking-regex
version: v0.2.1
description: |
  Masks or redacts Personally Identifiable Information (PII) in request and
  response payloads using configured regex patterns. Supports reversible
  masking and irreversible redaction modes.

parameters:
  type: object
  properties:
    piiEntities:
      type: array
      description: |
        Specifies PII entity definitions used for detection. Each item contains
        an entity name and the regex pattern used to match it.
      items:
        type: object
        properties:
          piiEntity:
            type: string
            description: Specifies the PII entity name, for example "EMAIL",
              "PHONE", or "SSN".
          piiRegex:
            type: string
            description: Specifies the regex pattern used to match the configured
              PII entity.
        required:
        - piiEntity
        - piiRegex
    jsonPath:
      type: string
      description: |
        Specifies the JSONPath used to extract the value to process. When
        empty, the entire payload is processed as plain text.
      default: ""
    redactPII:
      type: boolean
      description: |
        Specifies whether matched PII is permanently redacted as "*****"
        (true) or masked with reversible placeholders (false).
      default: false
  required:
  - piiEntities

systemParameters:         
  type: object
  properties: {}
